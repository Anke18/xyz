{
  "title": "GEOLYTIX | Shepherd Neame",
  "locate": {},
  "documentation": "documentation",
  "locales": {
    "GB": {
      "gazetteer": {
        "provider": "GOOGLE",
        "code": "GB",
        "placeholder": "e.g. London"
      },
      "view": {
        "lat": 51.18,
        "lng": -0.37,
        "z": 9
      },
      "minZoom": 6,
      "maxZoom": 18,
      "layers": {
        "base": {
          "group": "Base maps",
          "display": true,
          "name": "Mapbox Baselayer",
          "attribution": [
            "mapbox",
            "osm"
          ],
          "format": "tiles",
          "URI": "https://api.mapbox.com/styles/v1/dbauszus/ciozrimi3002bdsm8bjtn2v1y/tiles/256/{z}/{x}/{y}?&provider=MAPBOX"
        },
        "label": {
          "group": "Base maps",
          "display": true,
          "name": "Mapbox Labels",
          "attribution": [
            "mapbox",
            "osm"
          ],
          "format": "tiles",
          "URI": "https://api.mapbox.com/styles/v1/dbauszus/cj9puo8pr5o0c2sovhdwhkc7z/tiles/256/{z}/{x}/{y}?&provider=MAPBOX"
        },
        "demographics": {
          "display": false,
          "name": "Demographics",
          "format": "grid",
          "dbs": "XYZ",
          "geom": "geomcntr",
          "grid_color": "pop__11",
          "tables": {
            "6": "gb_hx_64k",
            "7": "gb_hx_32k",
            "8": "gb_hx_16k",
            "9": "gb_hx_8k",
            "10": "gb_hx_4k",
            "11": "gb_hx_2k",
            "12": "gb_hx_1k"
          },
          "grid_fields": {
            "Population 2017": "pop__17",
            "Population 2011": "pop__11",
            "Age 18 to 24": "age18_24",
            "Age 25 to 44": "age25_44",
            "Age 45 to 59": "age45_59",
            "Age 60 plus": "age60plus",
            "AB": "abhrp",
            "C1C2": "c1c2hrp",
            "DE": "dehrp",
            "Employed": "employed",
            "Unemployed": "eaunemp",
            "White Total Population": "whitetot",
            "Non White Population": "nonwhite",
            "Household - single": "pers1hhd",
            "Household - 2 persons": "pers2hhd",
            "Household - 2+ persons": "pers2plushhd",
            "Dwelling - own home (mortgaged/outright)": "own",
            "Social": "social",
            "Private renters": "rent"
          }
        },
        "report_test": {
          "display": true,
          "edit": {
            "properties": true,
            "point": true,
            "delete": true
          },
          "name": "Sites",
          "format": "cluster",
          "geom": "geom_4326",
          "dbs": "XYZ",
          "qID": "id",
          "table": "shepherd_neame.sites",
          "cluster_label": "pub_name",
          "infoj": [
            {
              "field": "isoline_5min",
              "fieldfx": "ST_asGeoJson(isoline_5min)",
              "type": "geometry",
              "edit": {
                "isoline": {
                  "range": 5
                }
              }
            },
            {
              "field": "isoline_10min",
              "fieldfx": "ST_asGeoJson(isoline_10min)",
              "type": "geometry",
              "edit": {
                "isoline": {
                  "range": 10
                }
              }
            },
            {
              "field": "isoline_15min",
              "fieldfx": "ST_asGeoJson(isoline_15min)",
              "type": "geometry",
              "edit": {
                "isoline": {
                  "range": 15
                }
              }
            },
            {
              "label": "Available tableviews",
              "type": "label"
            },
            {
              "type": "tableDefinition",
              "title": "Population Summary",
              "columns": [
                {
                  "type": "numeric",
                  "label": "0-5 mins",
                  "field": "min5",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_5min",
                    "geom_b": "geomcntr"
                  }
                },
                {
                  "type": "numeric",
                  "label": "0-10 mins",
                  "field": "min10",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_10min",
                    "geom_b": "geomcntr"
                  }
                },
                {
                  "type": "numeric",
                  "label": "0-15 mins",
                  "field": "min15",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_15min",
                    "geom_b": "geomcntr"
                  }
                }
              ],
              "rows": [
                {
                  "field": "pop__17",
                  "fieldfx": "SUM(b.pop__17)",
                  "label": "Current Population"
                },
                {
                  "field": "pop__11",
                  "fieldfx": "SUM(b.pop__11)",
                  "label": "Population 2011"
                },
                {
                  "field": "pop_growth",
                  "fieldfx": "SUM(b.pop__17 - b.pop__11) * 100 / SUM(b.pop__11)",
                  "label": "Population Growth"
                },
                {
                  "field": "students",
                  "fieldfx": "SUM(eac_student__11) + SUM(ein_student__11)",
                  "label": "Students"
                },
                {
                  "field": "non_white",
                  "fieldfx": "100*(SUM(pop__11) - SUM(ret_white_tot__11))/SUM(pop__11)",
                  "label": "% Non-White"
                },
                {
                  "field": "own_home",
                  "fieldfx": "100*SUM(own)/SUM(own+rent+social)",
                  "label": "Own Home"
                },
                {
                  "field": "private_rented",
                  "fieldfx": "100*SUM(rent)/SUM(own+rent+social)",
                  "label": "Private Rented"
                },
                {
                  "field": "social_rented",
                  "fieldfx": "100*SUM(social)/SUM(own+rent+social)",
                  "label": "Social Rented"
                },
                {
                  "field": "single_hhds",
                  "fieldfx": "100*SUM(pers1hhd)/SUM(pers1hhd+pers2hhd+pers2plushhd)",
                  "label": "Single Hhds"
                },
                {
                  "field": "hhds_two_ppl",
                  "fieldfx": "100*SUM(pers2hhd)/SUM(pers1hhd+pers2hhd+pers2plushhd)",
                  "label": "2 Person Hhds"
                },
                {
                  "field": "hhds_3plus",
                  "fieldfx": "100*SUM(pers2plushhd)/SUM(pers1hhd+pers2hhd+pers2plushhd)",
                  "label": "3+ Hhds"
                }
              ]
            },
            {
              "type": "tableDefinition",
              "title": "Age Profile",
              "columns": [
                {
                  "type": "integer",
                  "label": "0-5 mins",
                  "field": "min5",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_5min",
                    "geom_b": "geomcntr"
                  }
                },
                {
                  "type": "integer",
                  "label": "0-10 mins",
                  "field": "min10",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_10min",
                    "geom_b": "geomcntr"
                  }
                },
                {
                  "type": "integer",
                  "label": "0-15 mins",
                  "field": "min15",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_15min",
                    "geom_b": "geomcntr"
                  }
                },
                {
                  "field": "uk",
                  "exp": "age_under_18_uk, age_18to24_uk, age_25to29_uk, age_30to44_uk ,age_45to59_uk, age_60plus_uk, age_total_uk FROM shepherd_neame.report_summary"
                }
              ],
              "rows": [
                {
                  "field": "age_under_18",
                  "label": "< 18",
                  "fieldfx": "SUM(pop__11 - age_18to19__11 - age_20to24__11 - age_25to29__11 - age_30to44__11 - age_45to59__11 - age60plus)"
                },
                {
                  "field": "age_18to24",
                  "fieldfx": "SUM(age_18to19__11 + age_20to24__11)",
                  "label": "18 to 24"
                },
                {
                  "field": "age_25to29",
                  "fieldfx": "SUM(age_25to29__11)",
                  "label": "25 to 29"
                },
                {
                  "field": "age_30to44",
                  "fieldfx": "SUM(age_30to44__11)",
                  "label": "30 to 44"
                },
                {
                  "field": "age_45to59",
                  "fieldfx": "SUM(age_45to59__11)",
                  "label": "45 to 59"
                },
                {
                  "field": "age_60plus",
                  "fieldfx": "SUM(age60plus)",
                  "label": "60+"
                },
                {
                  "field": "age_profile_total",
                  "fieldfx": "SUM(pop__11)",
                  "label": "Total"
                }
              ],
              "agg": {
                "share15": {
                  "label": "% with 15 min",
                  "type": "integer",
                  "rows": [
                    "100*min15.age_under_18/min15.age_profile_total",
                    "100*min15.age_18to24/min15.age_profile_total",
                    "100*min15.age_25to29/min15.age_profile_total",
                    "100*min15.age_30to44/min15.age_profile_total",
                    "100*min15.age_45to59/min15.age_profile_total",
                    "100*min15.age_60plus/min15.age_profile_total",
                    "100*min15.age_profile_total/min15.age_profile_total"
                  ]
                },
                "age_uk_total": {
                  "label": "UK Total",
                  "type": "integer",
                  "rows": [
                    "uk.age_under_18_uk",
                    "uk.age_18to24_uk",
                    "uk.age_25to29_uk",
                    "uk.age_30to44_uk",
                    "uk.age_45to59_uk", 
                    "uk.age_60plus_uk", 
                    "uk.age_total_uk"
                  ]
                },
                "age_index": {
                  "label": "Age Profile Index",
                  "type": "numeric(1000, 2)",
                  "rows": [
                    "uk.age_total_uk*(100*min15.age_under_18/min15.age_profile_total)/uk.age_under_18_uk",
                    "uk.age_total_uk*(100*min15.age_18to24/min15.age_profile_total)/uk.age_18to24_uk",
                    "uk.age_total_uk*(100*min15.age_25to29/min15.age_profile_total)/uk.age_25to29_uk",
                    "uk.age_total_uk*(100*min15.age_30to44/min15.age_profile_total)/uk.age_30to44_uk",
                    "uk.age_total_uk*(100*min15.age_45to59/min15.age_profile_total)/uk.age_45to59_uk",
                    "uk.age_total_uk*(100*min15.age_60plus/min15.age_profile_total)/uk.age_60plus_uk",
                    "uk.age_total_uk*(100*min15.age_profile_total/min15.age_profile_total)/uk.age_total_uk"
                  ]
                }
              }
            },
            {
              "type": "tableDefinition",
              "title": "Social Grade",
              "columns": [
                {
                  "type": "integer",
                  "label": "0-5 mins",
                  "field": "min5",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_5min",
                    "geom_b": "geomcntr"
                  }
                },
                {
                  "type": "integer",
                  "label": "0-10 mins",
                  "field": "min10",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_10min",
                    "geom_b": "geomcntr"
                  }
                },
                {
                  "type": "integer",
                  "label": "0-15 mins",
                  "field": "min15",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_15min",
                    "geom_b": "geomcntr"
                  }
                },
                {
                  "type": "integer",
                  "field": "uk",
                  "exp": "social_grade_ab_uk, social_grade_c1_uk, social_grade_c2_uk, social_grade_de_uk, social_grade_total_uk FROM shepherd_neame.report_summary"
                }
              ],
              "rows": [
                {
                  "field": "sg_ab",
                  "fieldfx": "SUM(ski_ab__11)",
                  "label": "AB"
                },
                {
                  "field": "sg_c1",
                  "fieldfx": "SUM(ski_c1__11)",
                  "label": "C1"
                },
                {
                  "field": "sg_c2",
                  "fieldfx": "SUM(ski_c2__11)",
                  "label": "C2"
                },
                {
                  "field": "sg_de",
                  "fieldfx": "SUM(ski_de__11)",
                  "label": "DE"
                },
                {
                  "field": "sg_total",
                  "fieldfx": "SUM(pop__11)",
                  "label": "Total"
                }
              ],
              "agg": {
                "share15": {
                  "label": "% with 15 min",
                  "type": "integer",
                  "rows": [
                    "100*min15.sg_ab/min15.sg_total",
                    "100*min15.sg_c1/min15.sg_total",
                    "100*min15.sg_c2/min15.sg_total",
                    "100*min15.sg_de/min15.sg_total",
                    "100*min15.sg_total/min15.sg_total"
                  ]
                },
                "sg_uk_total": {
                  "label": "UK Total",
                  "type": "integer",
                  "rows": [
                    "uk.social_grade_ab_uk", 
                    "uk.social_grade_c1_uk", 
                    "uk.social_grade_c2_uk", 
                    "uk.social_grade_de_uk", 
                    "uk.social_grade_total_uk"
                  ]
                },
                "sg_index": {
                  "label": "Social Grade Index",
                  "type": "integer",
                  "rows":[
                    "uk.social_grade_total_uk*(100*min15.sg_ab/min15.sg_total)/uk.social_grade_ab_uk",
                    "uk.social_grade_total_uk*(100*min15.sg_c1/min15.sg_total)/uk.social_grade_c1_uk",
                    "uk.social_grade_total_uk*(100*min15.sg_c2/min15.sg_total)/uk.social_grade_c2_uk",
                    "uk.social_grade_total_uk*(100*min15.sg_de/min15.sg_total)/uk.social_grade_de_uk",
                    "uk.social_grade_total_uk*(100*min15.sg_total/min15.sg_total)/uk.social_grade_total_uk"
                  ]
                }
              }
            },
            {
              "type": "tableDefinition",
              "title": "OAC Profile",
              "columns": [
                {
                  "type": "integer",
                  "label": "0-5 mins",
                  "field": "min5",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_5min",
                    "geom_b": "geomcntr"
                  }
                },
                {
                  "type": "integer",
                  "label": "0-10 mins",
                  "field": "min10",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_10min",
                    "geom_b": "geomcntr"
                  }
                },
                {
                  "type": "integer",
                  "label": "0-15 mins",
                  "field": "min15",
                  "lookup": {
                    "table_a": "shepherd_neame.sites",
                    "table_b": "gb_hx_1k",
                    "geom_a": "isoline_15min",
                    "geom_b": "geomcntr"
                  }
                }
              ],
              "rows": [
                {
                  "field": "oac_1a",
                  "fieldfx": "SUM(CASE WHEN oac_group=1 THEN pop__17 ELSE 0 END)",
                  "label": "1a - Farming communities"
                },
                {
                  "field": "oac_1b",
                  "fieldfx": "sum(case when oac_group=2 then pop__17 else 0 end)",
                  "label": "1b - Rural tenants"
                },
                {
                  "field": "oac_1c",
                  "fieldfx": "sum(case when oac_group=3 then pop__17 else 0 end)",
                  "label": "1c - Ageing rural dwellers"
                },
                {
                  "field": "oac_2a",
                  "fieldfx": "sum(case when oac_group=3 then pop__17 else 0 end)",
                  "label": "2a - Students around campus"
                },
                {
                  "field": "oac_2b",
                  "fieldfx": "sum(case when oac_group=4 then pop__17 else 0 end)",
                  "label": "2b - Inner city students"
                },
                {
                  "field": "oac_2c",
                  "fieldfx": "sum(case when oac_group=5 then pop__17 else 0 end)",
                  "label": "2c - Comforable cosmopolitans"
                },
                {
                  "field": "oac_2d",
                  "fieldfx": "sum(case when oac_group=6 then pop__17 else 0 end)",
                  "label": "2d - Aspiring and affluent"
                },
                {
                  "field": "oac_3a",
                  "fieldfx": "sum(case when oac_group=7 then pop__17 else 0 end)",
                  "label": "3a - Ethnic family life"
                },
                {
                  "field": "oac_3b",
                  "fieldfx": "sum(case when oac_group=8 then pop__17 else 0 end)",
                  "label": "3b - Endeavouring ethnic mix"
                },
                {
                  "field": "oac_3c",
                  "fieldfx": "sum(case when oac_group=9 then pop__17 else 0 end)",
                  "label": "3c - Ethnic dynamics"
                },
                {
                  "field": "oac_3d",
                  "fieldfx": "sum(case when oac_group=10 then pop__17 else 0 end)",
                  "label": "3d - Aspirational techies"
                },
                {
                  "field": "oac_4a",
                  "fieldfx": "sum(case when oac_group=11 then pop__17 else 0 end)",
                  "label": "4a - Rented family living"
                },
                {
                  "field": "oac_4b",
                  "fieldfx": "sum(case when oac_group=13 then pop__17 else 0 end)",
                  "label": "4b - Challenged Asian terraces"
                },
                {
                  "field": "oac_4c",
                  "fieldfx": "sum(case when oac_group=14 then pop__17 else 0 end)",
                  "label": "4c - Asian traits"
                },
                {
                  "field": "oac_5a",
                  "fieldfx": "sum(case when oac_group=15 then pop__17 else 0 end)",
                  "label": "5a - Urban professionals and families"
                },
                {
                  "field": "oac_5b",
                  "fieldfx": "sum(case when oac_group=16 then pop__17 else 0 end)",
                  "label": "5b - Ageing urban living"
                },
                {
                  "field": "oac_6a",
                  "fieldfx": "sum(case when oac_group=17 then pop__17 else 0 end)",
                  "label": "6a - Suburban achievers"
                },
                {
                  "field": "oac_6b",
                  "fieldfx": "sum(case when oac_group=18 then pop__17 else 0 end)",
                  "label": "6b - Semi-detached suburbia"
                },
                {
                  "field": "oac_7a",
                  "fieldfx": "sum(case when oac_group=19 then pop__17 else 0 end)",
                  "label": "7a - Challenged diversity"
                },
                {
                  "field": "oac_7b",
                  "fieldfx": "sum(case when oac_group=20 then pop__17 else 0 end)",
                  "label": "7b - Constrained flat dwellers"
                },
                {
                  "field": "oac_7c",
                  "fieldfx": "sum(case when oac_group=21 then pop__17 else 0 end)",
                  "label": "7c - White communities"
                },
                {
                  "field": "oac_7d",
                  "fieldfx": "sum(case when oac_group=22 then pop__17 else 0 end)",
                  "label": "7d - Ageing city dwellers"
                },
                {
                  "field": "oac_8a",
                  "fieldfx": "sum(case when oac_group=23 then pop__17 else 0 end)",
                  "label": "8a - Industrious communities"
                },
                {
                  "field": "oac_8b",
                  "fieldfx": "sum(case when oac_group=24 then pop__17 else 0 end)",
                  "label": "8b - Challenged terraced workers"
                },
                {
                  "field": "oac_8c",
                  "fieldfx": "sum(case when oac_group=25 then pop__17 else 0 end)",
                  "label": "8c - Hard-pressed ageing workers"
                },
                {
                  "field": "oac_8d",
                  "fieldfx": "sum(case when oac_group=26 then pop__17 else 0 end)",
                  "label": "8d - Migration and churn"
                },
                {
                  "field": "oac_total",
                  "fieldfx": "sum(case when oac_group>0 then pop__17 else 0 end)",
                  "label": "Total"
                }
              ]
            }
          ]
        }
      }
    }
  }
}